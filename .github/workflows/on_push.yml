name: Push to branch

on:
  push:

jobs:
  push-type:
    name: Execute push on branch
    runs-on: ubuntu-latest
    outputs:
      value: ${{ steps.branch_type.outputs.value }}
    steps:
      - name: Checkout source code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Determine branch type
        id: branch_type
        run: |
          if [[ ${GITHUB_REF_NAME} == main* ]]; then
            echo "value=main" >> $GITHUB_OUTPUT
          elif [[ ${GITHUB_REF_NAME} == hotfix* ]]; then
            echo "value=hotfix" >> $GITHUB_OUTPUT
          elif [[ ${GITHUB_REF_NAME} == release* ]]; then
            echo "value=release" >> $GITHUB_OUTPUT
          elif [[ ${GITHUB_REF_NAME} == develop* ]]; then
            echo "value=develop" >> $GITHUB_OUTPUT
          else
            echo "value=feature" >> $GITHUB_OUTPUT
          fi
      - name: Push to main
        if: steps.branch_type.outputs.value == 'main'
        run: echo This is a push to main
      - name: Push to hotfix
        if: steps.branch_type.outputs.value == 'hotfix'
        run: echo This is a push to hotfix
      - name: Push to release
        if: steps.branch_type.outputs.value == 'release'
        run: echo This is a push to release
      - name: Push to develop
        if: steps.branch_type.outputs.value == 'develop'
        run: echo This is a push to develop
      - name: Push to feature
        if: steps.branch_type.outputs.value == 'feature'
        run: echo This is a push to feature
  develop-push:
    needs: [push-type]
    if: needs.push-type.outputs.value == 'develop'
    uses: ./.github/workflows/helper/on_push_develop.yml
  feature-push:
    needs: [push-type]
    if: needs.push-type.outputs.value == 'feature'
    uses: ./.github/workflows/helper/on_push_feature.yml
  